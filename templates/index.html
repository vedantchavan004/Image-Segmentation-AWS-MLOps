<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>YOLOv11 Detection & Segmentation</title>
</head>
<body>
    <h2>YOLOv11 Object Detection & Segmentation API</h2>

    <input type="file" id="imagefile" accept="image/*">
    <button onclick="uploadImage()">Upload & Predict</button>

    <div>
        <img id="resultImage" src="" width="600" style="margin-top:20px; display: none;">
        <div id="details"></div>
    </div>

<script>
async function uploadImage() {
    const formData = new FormData();
    const imagefile = document.querySelector('#imagefile');
    if (!imagefile.files[0]) {
        alert("Please select an image.");
        return;
    }
    formData.append("file", imagefile.files[0]);

    try {
        const response = await fetch("http://3.124.205.250:8000/predict/", { 
            method: "POST",
            body: formData
        });

        const data = await response.json();
        if (data.error) {
            alert("Error: " + data.error);
            return;
        }

        document.getElementById('resultImage').src = `/static/${data.output_image}`;
        document.getElementById('resultImage').style.display = "block";

        const detailsDiv = document.getElementById("details");
        detailsDiv.innerHTML = "";
        window.detections = data.detections;

        data.detections.forEach(det => {
            detailsDiv.innerHTML += `<p>Class: ${det.class}, BBox: ${det.bbox}</p>`;
        });
    } catch (error) {
        alert("Failed to process the image.");
    }
}
</script>

</body>
</html>
